<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overledgy | Overledger Demo App</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="icon" type="image/png" href="/assets/images/pic-pizza.png">
</head>
<body>
<div class="container">
    <header>
        <h1>OVERLEDGY</h1>
        <h2>Overledger Demo App</h2>
        <p>Want to start developing with Overledger? you may want to use this as your first simple example, look at how it works, play around, and do you own thing!</p>
    </header>
    <!-- Auth Token Section -->
    <section id="auth-section" class="card">
        <h2>Auth Token</h2>
        <div id="auth-token-display">
            <% if (token) { %>
                <div class="token-container">
                    <label for="currentToken">Current token:</label>
                    <textarea id="currentToken" rows="3" readonly><%= token %></textarea>
                </div>
            <% } else { %>
                <p>No token set. Please get an auth token before using the app.</p>
            <% } %>
            <button id="getAuthTokenBtn" class="btn btn-primary">Get Auth Token</button>
            <div id="auth-status"></div>
        </div>
    </section>
    <!-- Balance Section -->
    <section id="balance-section" class="card">
        <h2>Fetch Address Balance</h2>
        <div class="address-container">
            <label for="walletAddress">Wallet Address:</label>
            <textarea id="walletAddress" rows="1" readonly data-contract-address="<%= OVERLEDGER_API_CONFIG.TODO_LIST_CONTRACT_ADDRESS %>"><%= walletAddress %></textarea>
            <button id="fetchBalanceBtn" class="btn btn-secondary" <%= !token ? 'disabled="disabled"' : '' %>>Fetch Balance</button>
            <div id="balance-status"></div>
            <div id="balance-result" class="balance-result"></div>
        </div>
    </section>
    <!-- Todo App Section -->
    <section id="todo-section" class="card">
        <h2>Todo List</h2>
        <!-- Form to add a new Todo -->
        <form id="addTodoForm" class="todo-form">
            <input type="text" name="content" placeholder="Enter new todo" required>
            <button type="submit" class="btn btn-primary" id="addTodoBtn" <%= !token ? 'disabled="disabled"' : '' %>>Add Todo</button>
        </form>
        <div id="transaction-status"></div>
        <button id="fetchTodosBtn" class="btn btn-secondary" <%= !token ? 'disabled="disabled"' : '' %>>Fetch Todos from Blockchain</button>
        <div id="todoList" class="todo-container">
            <% if (locals.todos && todos.length > 0) { %>
                <h3>Your Todos</h3>
                <% todos.forEach(function(todo) { %>
                    <div class="todo-item <%= todo.completed ? 'completed' : '' %>">
                        <div class="todo-content">
                            <span class="todo-text"><%= todo.content %></span>
                            <span class="todo-id">ID: <%= todo.id %></span>
                        </div>
                        <div class="todo-actions">
                            <button class="btn-toggle" data-id="<%= todo.id %>">
                                <%= todo.completed ? 'Set as undone' : 'Mark as done!' %>
                            </button>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <p>Click "Fetch Todos" to load your todo items from the blockchain.</p>
            <% } %>
        </div>
    </section>
    <!-- Console Section -->
    <section id="console-section" class="card">
        <div class="consologger-header">
            <h2>Console</h2>
            <div class="consologger-controls">
                <button id="clearConsoleBtn" class="btn btn-danger btn-sm">Clear Console</button>
            </div>
        </div>
        <div id="consologger" class="consologger"></div>
    </section>
    <footer>
        <div class="footer-content">
            <p>Blockchain Todo App using Overledger API and Ethereum</p>
            <div class="social-icons">
                <a href="https://github.com/will7ech" target="_blank">
                    <img src="/assets/images/icon-github.png" alt="GitHub">
                </a>
                <a href="https://www.linkedin.com/in/will7ech/" target="_blank">
                    <img src="/assets/images/icon-linkedin.png" alt="LinkedIn">
                </a>
                <a href="https://www.reddit.com/user/Will7ech/" target="_blank">
                    <img src="/assets/images/icon-reddit.png" alt="Reddit">
                </a>
                <a href="https://will7ech.com" target="_blank">
                    <img src="/assets/images/icon-pizza.png" alt="Website">
                </a>
            </div>
        </div>
    </footer>
</div>
<script src="/assets/js/general.js"></script>
</body>
</html>